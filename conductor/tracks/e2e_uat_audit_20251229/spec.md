# Specification: Detailed E2E Testing and Initial UAT

## Overview
This track focuses on User Acceptance Testing (UAT) and end-to-end verification of the PA Dealing system. It combines "Live-Simulation" manual testing with a rigorous audit of the existing automated E2E test suite. The goal is to ensure that the "human feel" is correct and that our automated tests (Slack Mock, etc.) are fixed, updated, or retired to match the current system state.

## User Personas
- **Employee:** Submitting trades and managing profile via Slack.
- **Line Manager:** First-line approver in Slack.
- **Compliance Officer:** Managing the dashboard and accuracy metrics.
- **SMF16 (Head of Compliance):** Handling high-risk and MAR-sensitive escalations.

## Functional Requirements (User Journeys)
### 1. The Employee Journey (Manual & Automated)
- **Manual:** Walk through Slack Modal submissions, Chatbot interactions, and "Insider Info" blocks.
- **Automated:** Audit `tests/test_e2e_workflow.py` and `tests/test_slack_mock.py` to ensure they reflect the new Insider Info requirements.

### 2. The Approval Workflow (Manual & Automated)
- **Manual:** Verify Manager notifications and Dynamic Updates in a live Slack environment.
- **Automated:** Fix or update `tests/test_auto_approve.py` and escalation logic tests to match the latest MAR/MiFID detection rules.

### 3. The Compliance Oversight (Manual)
- **Manual:** Verify Dashboard data density, "Accuracy Metrics" calculations, and "Audit Log" fidelity.
- **Verification:** Ensure the dashboard correctly visualizes the data generated by both manual UAT and automated test runs.

## Test Suite Audit & Remediation
- **Audit:** Review all files in `tests/` to identify tests that are failing or obsolete due to recent architectural changes (e.g., Spec Compliance Gaps).
- **Remediate:** Fix failing E2E tests to align with new logic (Insider Info, MAR flags).
- **Prune:** Discard tests that are redundant or no longer applicable.

## Acceptance Criteria
- [x] Successful completion of the "Perfect Trade" journey (Manual).
- [x] Successful completion of the "Compliance Breach" journey (Manual).
- [x] **Automated Suite:** 100% pass rate for all retained E2E and Slack Mock tests inside the Docker environment.
- [x] **Validation:** Automated tests correctly simulate the "Insider Information" declaration and "MAR" detection logic.
- [x] Dashboard correctly displays metrics generated during the UAT and test audit.

## Out of Scope
- Writing entirely new unit tests for internal logic (focus is on E2E/UAT).
- Production deployment.
